{% include "header.html "%}
{% load staticfiles %}

<script language=javascript>

function testeajax(data){
	alert(data.message);
}

function carregarmarcacoes(){
	
}

function salva_marcacao(){
	Dajaxice.SabiaApp.salvarmarcacao(carregarmarcacoes,{'texto':document.getElementById('artigocorpo').text
}

function mudatextoartigo(data){
	document.getElementById('artigocorpo').textContent  = data.texto;
}

function traduz_en_pt(e){
	Dajaxice.SabiaApp.traduzir(mudatextoartigo,{'texto':document.getElementById('artigocorpo').textContent , 'de' : 'pt', 'para' : 'en'});
}

var xMousePosition = 0;
var yMousePosition = 0;
 
 
document.onmousemove = function(e){
  xMousePosition = e.clientX + window.pageXOffset - 100;
  yMousePosition = e.clientY + window.pageYOffset - 50;
};
 
 
function marcar(t){
var texto = document.getElementById("marc_texto");
texto.value += t;
}

function doMarcar(){
	marcar(getMarcacao())
}
 
function mymenu(element){
var t = getMarcacao();
  var x = document.getElementById('ctxmenu1');
  if(x) x.parentNode.removeChild(x);
 
  var d = document.createElement('div');
  d.setAttribute('class', 'ctxmenu');
  d.setAttribute('id', 'ctxmenu1');
  element.parentNode.appendChild(d);
  d.style.left = xMousePosition + "px";
  d.style.top = yMousePosition + "px";
  d.onmouseover = function(e) { this.style.cursor = 'pointer'; }
  d.onclick = function(e) { element.parentNode.removeChild(d); }
  document.body.onclick = function(e) { element.parentNode.removeChild(d); }
 
  var p = document.createElement('p');
  d.appendChild(p);
  p.onclick=function() { marcar(t) };
  p.setAttribute('class', 'ctxline');
  p.innerHTML = "Marcar";
  return false;
}

function getMarcacao() {
    var text = "", containerElement = null;
    if (typeof window.getSelection != "undefined") {
        var sel = window.getSelection();
        if (sel.rangeCount) {
            var node = sel.getRangeAt(0).commonAncestorContainer;
            containerElement = node.nodeType == 1 ? node : node.parentNode;
            text = sel.toString();
        }
    } else if (typeof document.selection != "undefined" &&
               document.selection.type != "Control") {
        var textRange = document.selection.createRange();
        containerElement = textRange.parentElement();
        text = textRange.text;
    }
    if(containerElement.id == "artigocorpo"){
     return text;
    } else {
     return "";
    }

}
</script>



    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="container">
      <!-- Example row of columns -->
      <div class="row">
        <div class="col-xs-6 col-lg-6">
          <div class="panel-heading">
          <a class="btn pull-right btn-success btn-xs" onmousedown="traduz_en_pt()"><i class="fa fa-plus-circle">&nbsp;Traduzir</i></a><a></a><i class="fa fa-search"></i>
            <a class="btn pull-right btn-success btn-xs" onmousedown="doMarcar()"><i class="fa fa-plus-circle">&nbsp;Marcar</i></a><a></a><i class="fa fa-search"></i>Titulo&nbsp;&nbsp;: {% if artigo %} {{artigo.titulo_artigo}} {% endif %}
          </div>
          <div style="height:400px;line-height:3em;overflow:auto;padding:5px;" id="artigocorpo" class="panel-body jumbotron" oncontextmenu="return mymenu(this)">{% if artigo %} {{artigo.texto_artigo}} {% endif %}</div>
          <div class="list-group">
            <a href="#" class="list-group-item active">Outros Artigos</a>
            <div class="list-group">
            {% for art in artigo.getArtSemelhantes %}
            <div class="list-group-item">{{art.titulo_artigo}}<a class="btn pull-right btn-danger btn-xs" href="/sabia/artigo/{{art.id}}/"><i class="fa fa-file-o"></i><font face="FontAwesome"><span style="line-height: 15px;">&nbsp;Ver</span></font></a>
            </div>
            {% endfor %}
            </div>
          </div>
        </div>
        <div class="col-xs-6 col-lg-6">
          <div class="panel-heading">
            <a class="btn pull-right btn-success btn-xs"><i class="fa fa-thumbs-o-up">&nbsp;</i>Salvar</a><i class="fa fa-search"></i> T&Atilde;&shy;tulo&nbsp;&nbsp;: {% if artigo %} {{artigo.titulo_artigo}} {% endif %}
          </div>
          <div class="list-group">
            <a href="#" class="list-group-item active">Marca&ccedil;&otilde;es:</a>
            <div class="list-group">
            {% for marcacao in fichamento.marcacao__set.all %}
            <div id="marcacao{{marcacao.id}}" class="list-group-item">{{marcacao.titulo_marcacao}}<a class="btn pull-right btn-default btn-xs"><i class="fa fa-file-o"></i><font face="FontAwesome"><span style="line-height: 15px;">&nbsp;Ver</span></font></a>
            </div>
            {% endfor %}
            </div>
          </div>
          <div class="form-group">
            <input type="hidden" id="idmarcacaosalvar" value="">
            <label class="control-label">Assunto</label>
            <div class="controls">
              <input type="text" class="form-control">
            </div>
            <label class="control-label">Conteudo</label>
            <textarea id="marc_texto" class="form-control"></textarea>
            
            
            <a class="btn btn-primary" onclick="salva_marcacao()">Adicionar</a>
          </div>
          
      </div>
    </div>
    <!-- /container -->



{% include "footer.html "%}